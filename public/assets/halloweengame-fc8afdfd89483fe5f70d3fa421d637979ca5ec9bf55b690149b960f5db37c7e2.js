function preload(){backgroundImage=loadImage("../images/halloweengame/halloween_background.png"),pumpkinNormal=loadImage("assets/pumpkin_normal.png"),scaredPumpkin=loadImage("assets/pumpkin_shocked.png"),candyCorn=loadImage("assets/candy_corn.png")}function setup(){createCanvas(800,600),bertha=new Witch(800,random(height)),casper=new Ghost(0,random(height));for(var s=0;15>s;s++)candies.push(new CandyCorn(random(0,width),random(0,height),random(5),random(1,3)));noiseDetail(24)}function draw(){1==state?(frameRate(30),doGamePlay()):0==state&&(background(0),fill(255,140,0),image(scaredPumpkin,mouseX,mouseY,150,150),textAlign(CENTER),textSize(50),text("You Got Mashed.",width/2,220),textSize(30),text("SCORE: "+(numGrabs-witchGrabs),width/2,270),textSize(20),text("Your Candy: "+numGrabs,width/2,320),text("Evil Spirits' Candy: "+witchGrabs,width/2,350),textSize(30),text("Press the SPACEBAR to play again!",width/2,400),1==keyPressed&&" "==key&&(numGrabs=0,witchGrabs=0,state=1,bertha.xPos=800,casper.xPos=0))}function doGamePlay(){background(backgroundImage),imageMode(CENTER);for(var s=0;s<candies.length;s++){var t=candies[s].checkHit(mouseX,mouseY);t&&numGrabs++;var i=candies[s].checkHit(bertha.xPos,bertha.yPos),e=candies[s].checkHit(casper.xPos,casper.yPos);(i||e)&&witchGrabs++,candies[s].display(),bertha.display(),casper.display()}noCursor();var a=dist(bertha.xPos,bertha.yPos,mouseX,mouseY),o=dist(casper.xPos,casper.yPos,mouseX,mouseY);75>a||75>o?state=0:image(pumpkinNormal,mouseX,mouseY,150,150),textAlign(LEFT),fill(255),textSize(30),text("Your Candy: "+numGrabs,100,40),text("Evil Candy: "+witchGrabs,500,40)}function CandyCorn(s,t,i,e){this.angle=0,this.size=150,this.xPos=s,this.yPos=t,this.perlinIndex=random(0,1e5),this.fallSpeed=i,this.rotation=e,this.checkHit=function(s,t){return s>this.xPos-this.size/2&&s<this.xPos+this.size/2&&t>this.yPos-this.size/2&&t<this.yPos+this.size/2?(this.yPos=random(-300,-50),!0):!1},this.display=function(){this.r=noise(this.perlinIndex),this.xMovement=map(this.r,0,1,-2,2),this.xPos+=this.xMovement,this.xPos=constrain(this.xPos,0,width-50),this.yPos+=this.fallSpeed,this.yPos>height&&(this.yPos=-50),this.perlinIndex+=.01,push(),translate(this.xPos,this.yPos),rotate(radians(this.angle)),image(candyCorn,0,0),pop(),this.angle+=this.rotation}}function Ghost(s,t){this.xSpeed=1,this.xPos=s,this.yPos=t,this.ghost=loadImage("assets/ghostright.png"),this.display=function(){image(this.ghost,this.xPos,this.yPos,200,161),this.xPos+=this.xSpeed,this.xPos>800&&(this.xPos-=800,this.yPos=random(height))}}function Witch(s,t){this.xSpeed=1,this.xPos=s,this.yPos=t,this.witch=loadImage("assets/witch.png"),this.display=function(){image(this.witch,this.xPos,this.yPos),this.xPos-=this.xSpeed,this.xPos<0&&(this.xPos+=800,this.yPos=random(height))}}var bertha,casper,candies=[],backgroundImage,pumpkinNormal,scaredPumpkin,candyCorn,state=1,numGrabs=0,witchGrabs=0;